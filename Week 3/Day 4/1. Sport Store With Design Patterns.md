# Unit of Work and Services for Products and Orders in SportStore ASP.NET MVC

## Overview

The implementation of the Unit of Work pattern and the services for managing Products and Orders within the SportStore ASP.NET MVC application is given as under. 
There are certain objectives to include or use these patterns. The **goal** is to facilitate effective database transactions and provide **a clean abstraction for product and order operations**.

## Unit of Work Pattern

The Unit of Work pattern is used to group multiple data operations into a single transaction, ensuring that all operations either succeed or fail together.

- In `Web` Project Add new folder named `Repositories`
### IUnitOfWork Interface

```csharp
public interface IUnitOfWork : IDisposable
{
    IProductRepository Products { get; }
    IOrderRepository Orders { get; }
    void Save();
}
```

### UnitOfWork Class

```csharp
public class UnitOfWork : IUnitOfWork
{
    private readonly ApplicationDbContext _context;

    public UnitOfWork(ApplicationDbContext context)
    {
        _context = context;
        Products = new ProductRepository(_context);
        Orders = new OrderRepository(_context);
    }

    public IProductRepository Products { get; private set; }
    public IOrderRepository Orders { get; private set; }

    public void Save()
    {
        _context.SaveChanges();
    }

    public void Dispose()
    {
        _context.Dispose();
    }
}
```

## Product Repository

The repository handles data access for the Product entity.

### IProductRepository Interface

```csharp
public interface IProductRepository
{
    Product GetProductById(int id);
    IEnumerable<Product> GetAllProducts();
    void AddProduct(Product product);
    void RemoveProduct(int id);
}
```

### ProductRepository Class

```csharp
public class ProductRepository : IProductRepository
{
    private readonly ApplicationDbContext _context;

    public ProductRepository(ApplicationDbContext context)
    {
        _context = context;
    }

    public Product GetProductById(int id)
    {
        return _context.Products.Find(id);
    }

    public IEnumerable<Product> GetAllProducts()
    {
        return _context.Products.ToList();
    }

    public void AddProduct(Product product)
    {
        _context.Products.Add(product);
    }

    public void RemoveProduct(int id)
    {
        var product = GetProductById(id);
        if (product != null)
        {
            _context.Products.Remove(product);
        }
    }
}
```

## Order Repository

The repository handles data access for the Order entity.

### IOrderRepository Interface

```csharp
public interface IOrderRepository
{
    Order GetOrderById(int id);
    IEnumerable<Order> GetAllOrders();
    void AddOrder(Order order);
    void RemoveOrder(int id);
}
```

### OrderRepository Class

```csharp
public class OrderRepository : IOrderRepository
{
    private readonly ApplicationDbContext _context;

    public OrderRepository(ApplicationDbContext context)
    {
        _context = context;
    }

    public Order GetOrderById(int id)
    {
        return _context.Orders.Find(id);
    }

    public IEnumerable<Order> GetAllOrders()
    {
        return _context.Orders.ToList();
    }

    public void AddOrder(Order order)
    {
        _context.Orders.Add(order);
    }

    public void RemoveOrder(int id)
    {
        var order = GetOrderById(id);
        if (order != null)
        {
            _context.Orders.Remove(order);
        }
    }
}
```
- Add new folder named `Services` and add the following inside this folder:
## Product Service

The Product service provides business logic for handling products.

### IProductService Interface

```csharp
public interface IProductService
{
    Product GetProduct(int id);
    IEnumerable<Product> GetAllProducts();
    void CreateProduct(Product product);
    void DeleteProduct(int id);
}
```

### ProductService Class

```csharp
public class ProductService : IProductService
{
    private readonly IUnitOfWork _unitOfWork;

    public ProductService(IUnitOfWork unitOfWork)
    {
        _unitOfWork = unitOfWork;
    }

    public Product GetProduct(int id)
    {
        return _unitOfWork.Products.GetProductById(id);
    }

    public IEnumerable<Product> GetAllProducts()
    {
        return _unitOfWork.Products.GetAllProducts();
    }

    public void CreateProduct(Product product)
    {
        _unitOfWork.Products.AddProduct(product);
        _unitOfWork.Save();
    }

    public void DeleteProduct(int id)
    {
        _unitOfWork.Products.RemoveProduct(id);
        _unitOfWork.Save();
    }
}
```

## Order Service

The Order service provides business logic for handling orders.

### IOrderService Interface

```csharp
public interface IOrderService
{
    Order GetOrder(int id);
    IEnumerable<Order> GetAllOrders();
    void CreateOrder(Order order);
    void DeleteOrder(int id);
}
```

### OrderService Class

```csharp
public class OrderService : IOrderService
{
    private readonly IUnitOfWork _unitOfWork;

    public OrderService(IUnitOfWork unitOfWork)
    {
        _unitOfWork = unitOfWork;
    }

    public Order GetOrder(int id)
    {
        return _unitOfWork.Orders.GetOrderById(id);
    }

    public IEnumerable<Order> GetAllOrders()
    {
        return _unitOfWork.Orders.GetAllOrders();
    }

    public void CreateOrder(Order order)
    {
        _unitOfWork.Orders.AddOrder(order);
        _unitOfWork.Save();
    }

    public void DeleteOrder(int id)
    {
        _unitOfWork.Orders.RemoveOrder(id);
        _unitOfWork.Save();
    }
}
```

## Conclusion

The implementation of the Unit of Work pattern along with the services for Products and Orders provides a structured approach to managing these entities in the SportStore Application. This design promotes maintainability and separation of concerns.
and will help us manage complex business logic and data access in a cleaner, more maintainable way.

### Additional Considerations

- *Error Handling*: Implement error handling in your service methods to manage exceptions effectively.
- *Logging*: Consider adding logging capabilities to track service operations.